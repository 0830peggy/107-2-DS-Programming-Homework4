library(lubridate); library(stringr); library(purrr); library(readr);
library(httr)
commitHistory <- content(GET("https://api.github.com/repos/r-hub/cranlogs/commits"))
View(commitHistory)
# oneCommitRecord
oneCommitRecord <- commitHistory[[10]]
oneCommitRecord
View(oneCommitRecord)
# df_commit
df_commit <- data.frame(
author=oneCommitRecord$commit$author$name,
commiter=oneCommitRecord$commit$committer$name
commitDate=oneCommitRecord$commit$committer$date
# df_commit
df_commit <- data.frame(
author=oneCommitRecord$commit$author$name,
commiter=oneCommitRecord$commit$committer$name,
commitDate=oneCommitRecord$commit$committer$date,
sha=oneCommitRecord$sha,
stringsAsFactors=F
)
df_commit
# commit_df_fun
commit_df_fun <- function(oneCommitRecord,df_commit){
df_commit <- data.frame(
author=oneCommitRecord$commit$author$name,
commiter=oneCommitRecord$commit$committer$name,
commitDate=oneCommitRecord$commit$committer$date,
sha=oneCommitRecord$sha,
stringsAsFactors=F
return(df_commit)
# commit_df_fun
commit_df_fun <- function(oneCommitRecord,df_commit){
df_commit <- data.frame(
author=oneCommitRecord$commit$author$name,
commiter=oneCommitRecord$commit$committer$name,
commitDate=oneCommitRecord$commit$committer$date,
sha=oneCommitRecord$sha,
stringsAsFactors=F,
return(df_commit)
}
# commit_df_fun
commit_df_fun <- function(oneCommitRecord,df_commit){
df_commit <- data.frame(
author=oneCommitRecord$commit$author$name,
commiter=oneCommitRecord$commit$committer$name,
commitDate=oneCommitRecord$commit$committer$date,
sha=oneCommitRecord$sha,
stringsAsFactors=F,
return(df_commit)
}
# commit_df_fun
commit_df_fun <- function(oneCommitRecord,df_commit){
df_commit <- data.frame(
author=oneCommitRecord$commit$author$name,
commiter=oneCommitRecord$commit$committer$name,
commitDate=oneCommitRecord$commit$committer$date,
sha=oneCommitRecord$sha,
stringsAsFactors=F
)
return(df_commit)
}
commit_df_fun(oneCommitRecord[[10]])
# commit_df_fun
commit_df_fun <- function(oneCommitRecord){
df_commit <- data.frame(
author=oneCommitRecord$commit$author$name,
commiter=oneCommitRecord$commit$committer$name,
commitDate=oneCommitRecord$commit$committer$date,
sha=oneCommitRecord$sha,
stringsAsFactors=F
)
return(df_commit)
}
commit_df_fun(oneCommitRecord[[10]])
# commit_df_fun
commit_df_fun <- function(oneCommitRecordInput){
df_commit <- data.frame(
author=oneCommitRecordInput$commit$author$name,
commiter=oneCommitRecordInput$commit$committer$name,
commitDate=oneCommitRecordInput$commit$committer$date,
sha=oneCommitRecordInput$sha,
stringsAsFactors=F
)
return(df_commit)
}
commit_df_fun(oneCommitRecord[[10]])
# oneCommitRecord
oneCommitRecord <- commitHistory[[10]]
oneCommitRecord
# df_commit
df_commit <- data.frame(
author=oneCommitRecord$commit$author$name,
commiter=oneCommitRecord$commit$committer$name,
commitDate=oneCommitRecord$commit$committer$date,
sha=oneCommitRecord$sha,
stringsAsFactors=F
)
df_commit
# commit_df_fun
commit_df_fun <- function(oneCommitRecordInput){
df_commit <- data.frame(
author=oneCommitRecordInput$commit$author$name,
commiter=oneCommitRecordInput$commit$committer$name,
commitDate=oneCommitRecordInput$commit$committer$date,
sha=oneCommitRecordInput$sha,
stringsAsFactors=F
)
return(df_commit)
}
commit_df_fun(oneCommitRecord[[10]])
# commit_df_fun
commit_df_fun <- function(oneCommitRecord){
df_commit <- data.frame(
author=oneCommitRecord$commit$author$name,
commiter=oneCommitRecord$commit$committer$name,
commitDate=oneCommitRecord$commit$committer$date,
sha=oneCommitRecord$sha,
stringsAsFactors=F
)
return(df_commit)
}
commit_df_fun(commitHistory[[10]])
# commit_df_fun
commit_df_fun <- function(oneCommitRecord){
df_commit <- data.frame(
author=oneCommitRecord$commit$author$name,
commiter=oneCommitRecord$commit$committer$name,
commitDate=oneCommitRecord$commit$committer$date,
sha=oneCommitRecord$sha,
stringsAsFactors=F
)
return(df_commit)
}
commit_df_fun(commitHistory[[2]])
# commit_df_fun
commit_df_fun <- function(oneCommitRecord){
df_commit <- data.frame(
author=oneCommitRecord$commit$author$name,
commiter=oneCommitRecord$commit$committer$name,
commitDate=oneCommitRecord$commit$committer$date,
sha=oneCommitRecord$sha,
stringsAsFactors=F
)
return(df_commit)
}
commit_df_fun
# df_allCommits
library(purrr)
map_dfr(commitHistory,df_commit) -> df_allCommits
# df_allCommits
library(purrr)
map_dfr(commitHistory,commit_df_fun) -> df_allCommits
df_allCommits
View(df_allCommits)
# df_allCommits$samePerson
df_allCommits$samePerson <- oneCommitRecord$commit$author$name == oneCommitRecord$commit$committer$name
df_allCommits$samePerson
# df_validCommits
df_validCommits <- df_allCommits[df_allCommits$samePerson]
View(df_allCommits)
# df_validCommits
df_validCommits <- df_allCommits[,df_allCommits$samePerson]
# df_validCommits
df_validCommits <- df_allCommits[,df_allCommits$samePerson==T]
# df_validCommits
df_validCommits <- df_allCommits[df_allCommits$samePerson==T,]
df_validCommits
# df_validCommits
df_validCommits <- df_allCommits[df_allCommits$samePerson,]
df_validCommits
# df_validCommits
df_validCommits <- df_allCommits[df_allCommits$samePerson==T,]
df_validCommits
# df_validCommits$commitDate
df_validCommits$commitDate <- ymd_hms(df_validCommits$commitDate,tz="UTC")
df_validCommits$commitDate <- with_tz(df_validCommits$commitDate,tzone="Asia/Taipei")
df_validCommits$commitDate
View(df_validCommits)
# df_validCommits$hh
df_validCommits$hh <- df_validCommits$commitDate[11,12]
# df_validCommits$hh
df_validCommits$hh <- df_validCommits$commitDate(hour)
# df_validCommits$hh
df_validCommits$hh <- df_validCommits$commitDate(hours)
View(df_validCommits)
# df_validCommits$hh
df_validCommits$hh <- df_validCommits$commitDate[hour]
# df_validCommits$hh
df_validCommits$hh <- (df_validCommits$commitDate,1,3)
# df_validCommits$hh
df_validCommits$hh <- df_validCommits$commitDate(h)
# df_validCommits$hh
df_validCommits$hh <- hour(df_validCommits$commitDate)
df_validCommits$hh
# df_validCommits$hh
df_validCommits$hh <- hour(df_validCommits$commitDate)
class(df_validCommits$hh)
# df_validCommits$hh
df_validCommits$hh <- hour(df_validCommits$commitDate)
df_validCommits$hh <- as.integer(df_validCommits$commitDate)
df_validCommits$commitDate
# df_validCommits$commitDate
df_validCommits$commitDate <- ymd_hms(df_validCommits$commitDate,tz="UTC")
df_validCommits$commitDate <- with_tz(df_validCommits$commitDate,tzone="Asia/Taipei")
df_validCommits$commitDate
# df_validCommits$hh
df_validCommits$hh <- hour(df_validCommits$commitDate)
df_validCommits$hh <- as.integer(df_validCommits$hh)
df_validCommits$hh
# df_validCommits$date
df_validCommits$date <- year(df_validCommits$commitDate),month(df_validCommits$commitDate)
# df_validCommits$date
yy <- year(df_validCommits$commitDate)
mm <- month(df_validCommits$commitDate)
dd <- date(df_validCommits$commitDate)
class(yy)
# df_validCommits$date
yy <- year(df_validCommits$commitDate)
mm <- month(df_validCommits$commitDate)
dd <- date(df_validCommits$commitDate)
dd
# df_validCommits$date
yy <- year(df_validCommits$commitDate)
mm <- month(df_validCommits$commitDate)
dd <- day(df_validCommits$commitDate)
dd
# df_validCommits$date
df_validCommits$date <- date(df_validCommits$commitDate)
class(df_validCommits$date)
# df_validCommits$date
df_validCommits$date <- date(df_validCommits$commitDate)
df_validCommits$date
View(df_allCommits)
View(df_validCommits)
?lubridate::wday()
# df_validCommits$weekday
library(lubridate)
lubridate::wday(df_validCommits$commitDate) -> df_validCommits$weekday
df_validCommits$weekday
# df_validCommits$weekday
library(lubridate)
lubridate::wday(df_validCommits$commitDate) -> df_validCommits$weekday
df_validCommits$weekday <- as.integer(df_validCommits$weekday)
df_validCommits$weekday
# df_validCommits$validCommit
trueweekday <- 1 <= df_validCommits$weekday & df_validCommits$weekday <= 3
truehour <- 12 <= df_validCommits$hh & df_validCommits$hh <= 23
df_validCommits$validCommit <- trueweekday==T & truehour==T
class(df_validCommits$validCommit)
# df_validCommits$validCommit
trueweekday <- 1 <= df_validCommits$weekday & df_validCommits$weekday <= 3
truehour <- 12 <= df_validCommits$hh & df_validCommits$hh <= 23
df_validCommits$validCommit <- trueweekday==T & truehour==T
df_validCommits$validCommit
# df_validCommitsSubsample
df_validCommitsSubsample <- df_validCommits[df_validCommits$validCommit==T,]
df_validCommitsSubsample
# validCounts
length(df_validCommitsSubsample)
# validCounts
nrow(df_validCommitsSubsample)
?length
nrow
?nrow
# validCounts
nrow(df_validCommits$date[df_validCommitsSubsample])
# validCounts
date(df_validCommitsSubsample) -> count1
# validCounts
date(df_validCommitsSubsample) -> count1
# validCounts
class(df_validCommitsSubsample$commitDate)
# validCounts
date(df_validCommitsSubsample$commitDate) -> count1
count1
# validCounts
date(df_validCommitsSubsample$commitDate) -> count1
as.factor(count1) -> count1
levels(count1)
# validCounts
date(df_validCommitsSubsample$commitDate) -> count1
as.factor(count1) -> count1
levels(count1) -> count2
validCounts <- as.integer(length(count2))
# validCounts
date(df_validCommitsSubsample$commitDate) -> count1
as.factor(count1) -> count1
levels(count1) -> count2
validCounts <- as.integer(length(count2))
validCounts
# validCounts
date(df_validCommitsSubsample$commitDate) -> count1
as.factor(count1) -> count1
levels(count1) -> count2
validCounts <- length(count2)
validCounts
# validCounts
date(df_validCommitsSubsample$commitDate) -> count1
as.factor(count1) -> count1
levels(count1) -> count2
validCounts <- length(count2)
class(validCounts)
# validCounts
date(df_validCommitsSubsample$commitDate) -> count1
as.factor(count1) -> count1
levels(count1) -> count2
validCounts <- as.integer(length(count2))
validCounts
# valid_commit_count
valid_commit_count <- function(valid_commit_count(username,reponame,wday,startHour,endHour)){
# valid_commit_count
valid_commit_count <- function(username,reponame,wday,startHour,endHour){
commitHistory <- content(GET("https://api.github.com/repos/r-hub/cranlogs/commits"))
df_allCommits <- map_dfr(commitHistory,commit_df_fun)
df_allCommits$samePerson <- oneCommitRecord$commit$author$name == oneCommitRecord$commit$committer$name
df_validCommits <- df_allCommits[df_allCommits$samePerson==T,]
df_validCommits$commitDate <- ymd_hms(df_validCommits$commitDate,tz="UTC")
df_validCommits$commitDate <- with_tz(df_validCommits$commitDate,tzone="Asia/Taipei")
df_validCommits$hh <- hour(df_validCommits$commitDate)
df_validCommits$hh <- as.integer(df_validCommits$hh)
df_validCommits$date <- date(df_validCommits$commitDate)
lubridate::wday(df_validCommits$commitDate) -> df_validCommits$weekday
df_validCommits$weekday <- as.integer(df_validCommits$weekday)
trueweekday <- wday <= df_validCommits$weekday & df_validCommits$weekday <= wday
truehour <- startHour <= df_validCommits$hh & df_validCommits$hh <= endHour
df_validCommits$validCommit <- trueweekday==T & truehour==T
df_validCommitsSubsample <- df_validCommits[df_validCommits$validCommit==T,]
date(df_validCommitsSubsample$commitDate) -> count1
as.factor(count1) -> count1
levels(count1) -> count2
validCounts <- as.integer(length(count2))
return(validCounts)
}
valid_commit_count
# valid_commit_count
valid_commit_count <- function(username,reponame,wday,startHour,endHour){
commitHistory <- content(GET("https://api.github.com/repos/r-hub/cranlogs/commits"))
df_allCommits <- map_dfr(commitHistory,commit_df_fun)
df_allCommits$samePerson <- oneCommitRecord$commit$author$name == oneCommitRecord$commit$committer$name
df_validCommits <- df_allCommits[df_allCommits$samePerson==T,]
df_validCommits$commitDate <- ymd_hms(df_validCommits$commitDate,tz="UTC")
df_validCommits$commitDate <- with_tz(df_validCommits$commitDate,tzone="Asia/Taipei")
df_validCommits$hh <- hour(df_validCommits$commitDate)
df_validCommits$hh <- as.integer(df_validCommits$hh)
df_validCommits$date <- date(df_validCommits$commitDate)
lubridate::wday(df_validCommits$commitDate) -> df_validCommits$weekday
df_validCommits$weekday <- as.integer(df_validCommits$weekday)
trueweekday <- wday <= df_validCommits$weekday & df_validCommits$weekday <= wday
truehour <- startHour <= df_validCommits$hh & df_validCommits$hh <= endHour
df_validCommits$validCommit <- trueweekday==T & truehour==T
df_validCommitsSubsample <- df_validCommits[df_validCommits$validCommit==T,]
date(df_validCommitsSubsample$commitDate) -> count1
as.factor(count1) -> count1
levels(count1) -> count2
validCounts <- as.integer(length(count2))
return(validCounts)
}
valid_commit_count("0830peggy","107-2-inclass-practice",4,15,16)
# valid_commit_count
valid_commit_count <- function(username,reponame,wday,startHour,endHour){
commitHistory <- content(GET("https://api.github.com/repos/r-hub/cranlogs/commits"))
df_allCommits <- map_dfr(commitHistory,commit_df_fun)
df_allCommits$samePerson <- oneCommitRecord$commit$author$name == oneCommitRecord$commit$committer$name
df_validCommits <- df_allCommits[df_allCommits$samePerson==T,]
df_validCommits$commitDate <- ymd_hms(df_validCommits$commitDate,tz="UTC")
df_validCommits$commitDate <- with_tz(df_validCommits$commitDate,tzone="Asia/Taipei")
df_validCommits$hh <- hour(df_validCommits$commitDate)
df_validCommits$hh <- as.integer(df_validCommits$hh)
df_validCommits$date <- date(df_validCommits$commitDate)
lubridate::wday(df_validCommits$commitDate) -> df_validCommits$weekday
df_validCommits$weekday <- as.integer(df_validCommits$weekday)
trueweekday <- wday <= df_validCommits$weekday & df_validCommits$weekday <= wday
truehour <- startHour <= df_validCommits$hh & df_validCommits$hh <= endHour
df_validCommits$validCommit <- trueweekday==T & truehour==T
df_validCommitsSubsample <- df_validCommits[df_validCommits$validCommit==T,]
date(df_validCommitsSubsample$commitDate) -> count1
as.factor(count1) -> count1
levels(count1) -> count2
validCounts <- as.integer(length(count2))
return(validCounts)
}
valid_commit_count("0830peggy","107-2-inclass-practice",4,15,16)
# valid_commit_count
valid_commit_count <- function(username,reponame,wday,startHour,endHour){
commitHistory <- content(GET("https://api.github.com/repos/0830peggy/107-2-inclass-practice/commits"))
df_allCommits <- map_dfr(commitHistory,commit_df_fun)
df_allCommits$samePerson <- oneCommitRecord$commit$author$name == oneCommitRecord$commit$committer$name
df_validCommits <- df_allCommits[df_allCommits$samePerson==T,]
df_validCommits$commitDate <- ymd_hms(df_validCommits$commitDate,tz="UTC")
df_validCommits$commitDate <- with_tz(df_validCommits$commitDate,tzone="Asia/Taipei")
df_validCommits$hh <- hour(df_validCommits$commitDate)
df_validCommits$hh <- as.integer(df_validCommits$hh)
df_validCommits$date <- date(df_validCommits$commitDate)
lubridate::wday(df_validCommits$commitDate) -> df_validCommits$weekday
df_validCommits$weekday <- as.integer(df_validCommits$weekday)
trueweekday <- wday <= df_validCommits$weekday & df_validCommits$weekday <= wday
truehour <- startHour <= df_validCommits$hh & df_validCommits$hh <= endHour
df_validCommits$validCommit <- trueweekday==T & truehour==T
df_validCommitsSubsample <- df_validCommits[df_validCommits$validCommit==T,]
date(df_validCommitsSubsample$commitDate) -> count1
as.factor(count1) -> count1
levels(count1) -> count2
validCounts <- as.integer(length(count2))
return(validCounts)
}
valid_commit_count("0830peggy","107-2-inclass-practice",4,15,16)
# valid_commit_count
valid_commit_count <- function(username,reponame,wday,startHour,endHour){
commitHistory <- content(GET("https://api.github.com/repos/username/reponame/commits"))
df_allCommits <- map_dfr(commitHistory,commit_df_fun)
df_allCommits$samePerson <- oneCommitRecord$commit$author$name == oneCommitRecord$commit$committer$name
df_validCommits <- df_allCommits[df_allCommits$samePerson==T,]
df_validCommits$commitDate <- ymd_hms(df_validCommits$commitDate,tz="UTC")
df_validCommits$commitDate <- with_tz(df_validCommits$commitDate,tzone="Asia/Taipei")
df_validCommits$hh <- hour(df_validCommits$commitDate)
df_validCommits$hh <- as.integer(df_validCommits$hh)
df_validCommits$date <- date(df_validCommits$commitDate)
lubridate::wday(df_validCommits$commitDate) -> df_validCommits$weekday
df_validCommits$weekday <- as.integer(df_validCommits$weekday)
trueweekday <- wday <= df_validCommits$weekday & df_validCommits$weekday <= wday
truehour <- startHour <= df_validCommits$hh & df_validCommits$hh <= endHour
df_validCommits$validCommit <- trueweekday==T & truehour==T
df_validCommitsSubsample <- df_validCommits[df_validCommits$validCommit==T,]
date(df_validCommitsSubsample$commitDate) -> count1
as.factor(count1) -> count1
levels(count1) -> count2
validCounts <- as.integer(length(count2))
return(validCounts)
}
valid_commit_count("0830peggy","107-2-inclass-practice",4,15,16)
# valid_commit_count
valid_commit_count <- function(username,reponame,wday,startHour,endHour){
commitHistory <- content(GET("https://api.github.com/username/reponame/commits"))
df_allCommits <- map_dfr(commitHistory,commit_df_fun)
df_allCommits$samePerson <- oneCommitRecord$commit$author$name == oneCommitRecord$commit$committer$name
df_validCommits <- df_allCommits[df_allCommits$samePerson==T,]
df_validCommits$commitDate <- ymd_hms(df_validCommits$commitDate,tz="UTC")
df_validCommits$commitDate <- with_tz(df_validCommits$commitDate,tzone="Asia/Taipei")
df_validCommits$hh <- hour(df_validCommits$commitDate)
df_validCommits$hh <- as.integer(df_validCommits$hh)
df_validCommits$date <- date(df_validCommits$commitDate)
lubridate::wday(df_validCommits$commitDate) -> df_validCommits$weekday
df_validCommits$weekday <- as.integer(df_validCommits$weekday)
trueweekday <- wday <= df_validCommits$weekday & df_validCommits$weekday <= wday
truehour <- startHour <= df_validCommits$hh & df_validCommits$hh <= endHour
df_validCommits$validCommit <- trueweekday==T & truehour==T
df_validCommitsSubsample <- df_validCommits[df_validCommits$validCommit==T,]
date(df_validCommitsSubsample$commitDate) -> count1
as.factor(count1) -> count1
levels(count1) -> count2
validCounts <- as.integer(length(count2))
return(validCounts)
}
valid_commit_count("0830peggy","107-2-inclass-practice",4,15,16)
# valid_commit_count
valid_commit_count <- function(username,reponame,wday,startHour,endHour){
commitHistory <- content(GET("https://github.com/username/reponame/commits/master"))
df_allCommits <- map_dfr(commitHistory,commit_df_fun)
df_allCommits$samePerson <- oneCommitRecord$commit$author$name == oneCommitRecord$commit$committer$name
df_validCommits <- df_allCommits[df_allCommits$samePerson==T,]
df_validCommits$commitDate <- ymd_hms(df_validCommits$commitDate,tz="UTC")
df_validCommits$commitDate <- with_tz(df_validCommits$commitDate,tzone="Asia/Taipei")
df_validCommits$hh <- hour(df_validCommits$commitDate)
df_validCommits$hh <- as.integer(df_validCommits$hh)
df_validCommits$date <- date(df_validCommits$commitDate)
lubridate::wday(df_validCommits$commitDate) -> df_validCommits$weekday
df_validCommits$weekday <- as.integer(df_validCommits$weekday)
trueweekday <- wday <= df_validCommits$weekday & df_validCommits$weekday <= wday
truehour <- startHour <= df_validCommits$hh & df_validCommits$hh <= endHour
df_validCommits$validCommit <- trueweekday==T & truehour==T
df_validCommitsSubsample <- df_validCommits[df_validCommits$validCommit==T,]
date(df_validCommitsSubsample$commitDate) -> count1
as.factor(count1) -> count1
levels(count1) -> count2
validCounts <- as.integer(length(count2))
return(validCounts)
}
valid_commit_count("0830peggy","107-2-inclass-practice",4,15,16)
